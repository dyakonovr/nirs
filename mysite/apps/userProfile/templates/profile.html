{% extends 'header.html' %}
{% load static %}
{% block title %}Профиль{% endblock title %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/styles.css' %}">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
    crossorigin="anonymous"></script>
<div class="col-7 mt-3 mb-5 mx-auto bg-info-subtle d-flex flex-column p-4 rounded-4">
    <!-- Это ошибка при смене пароля, сделай выплывающее окно -->
    {% for message in messages %}
        <!-- ошибка при смене -->
        {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}<span>{{message}}</span>{% endif %} 
        <!-- успешная смена -->
        {% if message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}<span>{{message}}</span>{% endif %}
    {% endfor %}
    <h1 class="mb-4">Профиль</h1>
    <div class="tabs">
        <ul class="tabs__list mb-3 w-100">
            <li class="tabs__item w-50"><button class="tabs__btn fs-5 tabs__btn--active rounded-start-4"
                    data-tabs-path="data">Мои данные</button>
            </li>
            <li class="tabs__item w-50"><button class="tabs__btn fs-5 rounded-end-4" data-tabs-path="results">Результаты
                    тестов</button></li>
        </ul>
        <div class="tabs__content tabs__content--active" data-tabs-target="data">
            <div class="content d-flex flex-column">
                <div class="profile d-flex flex-column">
                    <p class="fs-5 mb-1 mt-0">Имя пользователя: <span class="fw-semibold">{{ username }}</span></p>
                    <p class="fs-5 mb-1 mt-0">Электронная почта: <span class="fw-semibold">{{ email }}</span></p>
                    <p class="fs-5 mb-2 mt-0">Номер телефона: <span class="fw-semibold">{{ phoneNumber }}</span></p>
                    <div class="mt-2">
                        <button type="submit" class="btn btn-warning" data-bs-toggle="modal"
                            data-bs-target="#exampleModal">Изменить
                            пароль</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="tabs__content" data-tabs-target="results">
            <div class="content d-flex flex-column">
                <div class="d-flex flex-column">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Тема</th>
                                <th scope="col" class="text-center">Результат</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for topic, score in scores.items %}
                                <tr>
                                    <th scope="row">{{ forloop.counter }}</th>
                                    <td>{{ topic }}</td>
                                    <td class="text-center">{{ score }}/7</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" tabindex="-1" id="exampleModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header border-bottom-0">
                    <h5 class="modal-title">Изменить пароль</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="" method="post">
                        {% csrf_token %}
                        {% for field in form %}
                            {{field}}
                        {% endfor %}
                        <div class="modal-footer px-0 border-top-0">
                            <button type="submit" class="btn btn-primary d-flex me-auto ms-0">Сохранить пароль</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <a href="{% url 'logout' %}" class="mt-3 btn btn-primary col-4 btn-lg mx-auto">Выйти из аккаунта</a>
</div>
<script src="{% static 'js/tabs.js' %}"></script>
{% endblock content %}